<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAML-LDAP Bridge - Temporary Credentials</title>

    <script>
      function copyToClipboard(text) {
        navigator.clipboard
          .writeText(text)
          .then(() => alert("Copied to clipboard!"));
      }
    </script>
  </head>
  <body>
    <h1>Authentication Successful</h1>

    <div class="success">
      Welcome, {{ user_info.display_name or user_info.username }}! Your
      temporary LDAP credentials have been generated.
    </div>

    <div class="card">
      <h2>User Information</h2>
      <table>
        <tr>
          <td><strong>Username:</strong></td>
          <td>{{ user_info.username }}</td>
        </tr>
        <tr>
          <td><strong>Name:</strong></td>
          <td>
            {{ user_info.display_name or (user_info.first_name + ' ' +
            user_info.last_name) if user_info.first_name else user_info.username
            }}
          </td>
        </tr>
        <tr>
          <td><strong>Email:</strong></td>
          <td>{{ user_info.email or 'Not provided' }}</td>
        </tr>
        {% if user_info.affiliation %}
        <tr>
          <td><strong>Affiliation:</strong></td>
          <td>{{ user_info.affiliation }}</td>
        </tr>
        {% endif %} {% if user_info.groups %}
        <tr>
          <td><strong>Groups:</strong></td>
          <td>
            {{ user_info.groups if user_info.groups is string else ',
            '.join(user_info.groups) }}
          </td>
        </tr>
        {% endif %}
      </table>
    </div>

    <div class="card">
      <h2>Temporary LDAP Credentials</h2>
      <p>
        <strong>⚠️ Important:</strong> These credentials expire at {{
        credentials.expires_at }}.
      </p>
      <div class="credentials">
        <div>
          <strong>LDAP Server:</strong> {{ credentials.ldap_server }}:{{
          credentials.ldap_port }}
          <button
            class="btn copy-btn"
            onclick="copyToClipboard('{{ credentials.ldap_server }}:{{ credentials.ldap_port }}')"
          >
            Copy
          </button>
        </div>
        <div>
          <strong>Bind DN:</strong> {{ credentials.bind_dn }}
          <button
            class="btn copy-btn"
            onclick="copyToClipboard('{{ credentials.bind_dn }}')"
          >
            Copy
          </button>
        </div>
        <div>
          <strong>Password:</strong> {{ credentials.password }}
          <button
            class="btn copy-btn"
            onclick="copyToClipboard('{{ credentials.password }}')"
          >
            Copy
          </button>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Actions</h2>
      <a href="/demo" class="btn">Test LDAP Connection</a>
      <a href="/status" class="btn">System Status</a>
      <a href="/logout" class="btn btn-danger">Logout</a>
    </div>
  </body>
</html>
