<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAML-LDAP Bridge - Credentials</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />

    <script>
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text);

        const statusBox = document.getElementById("status-message");
        if (statusBox) {
          statusBox.innerText = "Password copied to clipboard!";
          statusBox.className = "success";
        }
      }
    </script>
  </head>
  <body>
    <div class="container">
      <h1>Authentication Successful</h1>

      <div id="status-message" class="info">
        Welcome, {{ user_info.username or user_info.display_name or 'User' }}!
      </div>

      <p>
        Your temporary LDAP credentials expire at:<br />
        <strong>
          {% set parts = credentials.expires_at.split('T') %} {% set date_parts
          = parts[0].split('-') %} {% set time_parts = parts[1].split(':') %} {%
          set hour = time_parts[0]|int %} {% set ampm = 'am' if hour < 12 else
          'pm' %} {% set hour12 = hour if hour <= 12 else hour - 12 %} {% set
          hour12 = 12 if hour12 == 0 else hour12 %} {{ date_parts[2] }}-{{
          date_parts[1] }}-{{ date_parts[0] }}, {{ hour12 }}:{{ time_parts[1]
          }}{{ ampm }}
        </strong>
      </p>

      <div class="credentials-box">
        <strong>Password:</strong> {{ credentials.password }}
      </div>

      <button
        class="btn"
        onclick="copyToClipboard('{{ credentials.password }}')"
      >
        Copy Password
      </button>

      <div style="margin-top: 15px">
        <a href="/demo" class="btn">Login</a>
        <a href="/logout" class="btn btn-danger">Reauthenticate</a>
      </div>
    </div>
  </body>
</html>
