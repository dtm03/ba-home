<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAML-LDAP Bridge - Credentials</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />

    <script>
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text);
        const statusBox = document.getElementById("status-message");
        if (statusBox) {
          statusBox.innerText = "Password copied to clipboard!";
          statusBox.className = "success";
        }
      }
    </script>
  </head>
  <body>
    <div class="container">
      <h1>Authentication Successful</h1>

      <div id="status-message" class="info">
        Welcome, {{ user_info['username'] or user_info['display_name'] or 'User'
        }}!
      </div>

      <p>
        Your temporary LDAP credentials expire at:<br />
        <strong>
          {% if credentials['expires_at'] and 'T' in credentials['expires_at']
          %} {% set parts = credentials['expires_at'].split('T') %} {% set
          date_p = parts[0].split('-') %} {% set time_p = parts[1].split(':') %}
          {% set hour = time_p[0]|int %} {% set ampm = 'am' if hour < 12 else
          'pm' %} {% set h12 = hour if hour <= 12 else hour - 12 %} {% set h12 =
          12 if h12 == 0 else h12 %} {{ date_p[2] }}-{{ date_p[1] }}-{{
          date_p[0] }}, {{ h12 }}:{{ time_p[1] }}{{ ampm }} {% else %} {{
          credentials['expires_at'] }} {% endif %}
        </strong>
      </p>

      <div class="credentials-box">
        <strong>Password:</strong> {{ credentials['password'] }}
      </div>

      <button
        class="btn"
        onclick="copyToClipboard('{{ credentials['password'] }}')"
      >
        Copy Password
      </button>

      <div style="margin-top: 15px">
        <a href="/login" class="btn">Login</a>
        <a href="/logout" class="btn btn-danger">Reauthenticate</a>
      </div>
    </div>
  </body>
</html>
